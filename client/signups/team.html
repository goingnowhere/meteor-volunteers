<template name="teamShiftsTable">
  <table class="table">
    <thead>
      <th></th>
      <th>{{_ "time"}}</th>
      <th>{{_ "name"}}</th>
      <th>{{_ "positions"}}</th>
      <th></th>
    </thead>
    {{#each shift in shifts}}
      <tr>
        <td>{{#if $eq shift.priority "essential"}}<div class="text-danger">{{fa "exclamation-circle"}}</div>{{/if}}</td>
        <td>{{formatTime shift.start}} - {{formatTime shift.end}}</td>
        <td>{{shift.title}}
          {{#if ($eq shift.policy 'public')}}{{fa 'globe'}}{{/if}}
          {{#if ($eq shift.policy 'private')}}{{fa 'user-secret'}}{{/if}}
          {{#if ($eq shift.policy 'requireApproval')}}{{fa 'lock'}}{{/if}}
        </td>
        <td class="pull-rigth">
          <span class="badge badge-pill badge-primary">{{shift.needed}} / {{shift.confirmed}}</span>
        </td>
        <td>
          <div class="btn-group pull-right">
            <button type="button" class="btn btn-default dropdown-toggle"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li class="dropdown-item"><a href="#" data-action="edit" data-id="{{shift._id}}">
                {{fa "pencil-square-o"}} {{_ "edit"}}</a></li>
              <li class="dropdown-item"><a href="#" data-action="delete" data-id="{{shift._id}}">
                {{fa "trash-o"}} {{_ "remove"}}</a></li>
              <li class="dropdown-item"><a href="#" data-action="clone" data-id="{{shift._id}}">
                {{fa "clone"}} {{_ "clone"}}</a></li>
            </ul>
          </div>
        </td>
      </tr>
    {{/each}}
  </table>
</template>

<template name="teamShiftsView">
  <div class="panel panel-default">
    <div class="panel-heading clearfix">
      <h4>{{date}}</h4>
    </div>
    <div class="panel-body">
      {{> teamShiftsTable _id=_id}}
    </div>
  </div>
</template>

<template name="teamTasksView">
  <div class="panel
    {{#if $gt timeleft 4}}panel-warning{{else}}
      {{#if $lte timeleft 0}}panel-danger{{else}}
        panel-default
      {{/if}}
    {{/if}}">
    <div class="panel-heading clearfix">
      <div class="btn-group pull-right">
        <button type="button" class="btn btn-default btn-circle dropdown-toggle"
          data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
          <li class="dropdown-item"><a href="#" data-action="toggle" data-id="{{_id}}">
            {{fa "check"}}
            {{#if $eq status "done"}}{{_ "mark_pending"}}{{/if}}
            {{#if $eq status "pending"}}{{_ "mark_done"}}{{/if}}
          </a></li>
          <li class="dropdown-item"><a href="#" data-action="edit" data-id="{{_id}}">
            {{fa "pencil-square-o"}} {{_ "edit"}}</a></li>
          <li class="dropdown-item"><a href="#" data-action="delete" data-id="{{_id}}">
            {{fa "trash-o"}} {{_ "remove"}}</a></li>
          <li class="dropdown-item"><a href="#" data-action="archive" data-id="{{_id}}">
            {{fa "archive"}} {{_ "archive"}}</a></li>
        </ul>
      </div>
      {{#if $eq status "done"}}{{fa "check"}}{{/if}}
      {{#if $eq status "archived"}}{{fa "archive"}}{{/if}}
      {{#if $eq status "overdue"}}{{fa "danger"}}{{/if}}

      {{#if ($eq policy 'public')}}{{fa 'globe'}}{{/if}}
      {{#if ($eq policy 'private')}}{{fa 'user-secret'}}{{/if}}
      {{#if ($eq policy 'requireApproval')}}{{fa 'lock'}}{{/if}}

      <h4>{{title}}</h4>
    </div>
    <div class="panel-body">
      {{_ "due_date"}}: {{formatDate dueDate}}
      <div class="badge badge-pill badge-primary pull-right">{{vacant}} / {{confirmed}}</div>
    </div>
  </div>
</template>

<template name="teamDayViewGrid">
  <div class="panel">
    <div class="panel-heading clearfix">
      <div class="btn-group pull-right">
        <a href="{{pathFor teamSignupsList _id=_id}}" class="btn btn-default btn-sm" >
          {{_ "signups" }}
        </a>
        <button type="button" class="btn btn-info btn-sm dropdown-toggle"
          data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <i class="fa fa-wrench fa-fw"></i>
        </button>
        <ul class="dropdown-menu">
          <li class="dropdown-item"><a href="#" data-action="edit" data-id="{{teamId}}">
            {{fa "pencil-square-o"}} {{_ "edit"}}</a></li>
          <li class="dropdown-item"><a href="#" data-action="delete" data-id="{{teamId}}">
            {{fa "trash-o"}} {{_ "remove"}}</a></li>
        </ul>
      </div>
      <h4>{{_ "team"}} : {{name}}</h4>
    </div>
  </div>
  {{_ "team_leads"}} :
  <ul class="inline">
    {{#each lead in allLeads}}
      <li>{{getUserName lead.userId}} ({{lead.title}})</li>
    {{/each}}
  </ul>
  <div class="row">
    <div class="col-md-6">
      <table class="table">
        <tr>
          <td><h3>{{_ "shifts"}}</h3></td>
          <td align="right">
            <button type="button" class="btn btn-default btn-sm" data-action="addShift">
              {{fa "plus"}} {{_ "add_new_shift"}}
            </button>
          </td>
        </tr>
      </table>
      {{#each date in allDates}}
          {{> teamShiftsView _id=_id date=date}}
      {{/each}}
    </div>
    <div class="col-md-6">
      <table class="table">
        <tr>
          <td><h3>{{_ "tasks"}}</h3></td>
          <td align="right">
            <button type="button" class="btn btn-default btn-sm" data-action="addTask">
              {{fa "plus"}} {{_ "add_new_task"}}
            </button>
          </td>
        </tr>
      </table>
      <div class="form-inline">
        {{#each s in taskStatus}}
          <label class="control-label">{{_ s.status}}</label>
          <input type="checkbox" id="taskStatus" value="{{s.status}}"
            class="form-control" {{s.isChecked}}>
        {{/each}}
      </div>
      {{#each task in allTasks}}
        {{> teamTasksView task}}
      {{/each}}
    </div>
  </div>
</template>
