<!-- used to display all shifts for a given team
     Args: team
-->
<template name="teamShiftsTable">
  <table class="table">
    {{#each family in groupedShifts}}
    <thead class="thead-default">
      <tr class="shiftFamily table-active">
        <td colspan="2"><h5>{{family.title}}</h5></td>
        <td>
          <button type="button" class="btn btn-default btn-sm"
            data-id="{{family.first._id}}" data-type="shift" data-action="edit_group">
            {{fa "pencil-square-o"}} {{__ ".edit_group"}}
          </button>
        </td>
        <td>
          <button type="button" class="btn btn-default btn-sm"
            data-id="{{family.first._id}}" data-type="shift" data-action="add_date">
            {{fa "calendar"}} {{__ ".add_date"}}
          </button>
        </td>
        <!-- <td>
          <button type="button" class="btn btn-default btn-sm"
            data-toggle="collapse" data-target=".{{family.class}}">
            {{fa "angle-up"}}
          </button>
        </td> -->
      </tr>
    </thead>
    <tbody>
      {{#each shift in family.shifts }}
        <tr class="shift {{family.class}}" data-id="{{shift._id}}" data-type="{{shift.type}}">
          <th scope="row">
            <span>
            {{#if $eq shift.priority "essential"}}
              <span class="text-danger">{{fa "exclamation-circle"}}</span>
            {{/if}}
            {{#if ($eq shift.policy 'private')}}{{fa 'user-secret'}}{{/if}}
            {{#if ($eq shift.policy 'requireApproval')}}{{fa 'lock'}}{{/if}}
          </span>
          </th>
          <td> {{> shiftDateInline shift}} </td>
          <td>
            <span class="badge badge-pill badge-primary">{{shift.needed}} / {{shift.confirmed}}</span>
          </td>
          <td>
            <button class="btn btn-sm btn-circle" href="#"
              data-action="edit" data-id="{{shift._id}}" data-type="shift">
                  {{fa "pencil-square-o"}}</button>
            <button class="btn btn-sm btn-circle" href="#"
              data-action="delete" data-id="{{shift._id}}" data-type="shift">
                  {{fa "trash-o"}}</button>
            {{> Template.contentBlock shift=shift }}
          </td>
        </tr>
        {{#if $gt shift.confirmed 0}}
          <tr class="shift {{family.class}}">
            <td colspan="4">
              <ol>
                {{#each signup in shift.volunteers }}
                  <li>{{getUserName signup.userId}}
                    (<a href="#"
                        data-action="un-enroll"
                        data-userid="{{signup.userId}}"
                        data-shiftid="{{shift._id}}">
                      {{__ ".remove"}}
                    </a>)
                  </li>
                {{/each}}
              </ol>
            </td>
          </tr>
        {{/if}}
      {{/each}}
    </tbody>
    {{/each}}
  </table>
</template>

<!-- used to display all projects for a given team
     Args: team
-->
<template name="teamProjectsTable">
  <table class="table">
    {{#each project in allProjects }}
      <tr>
        <td>
          {{#if $eq project.priority "essential"}}
            <div class="text-danger">{{fa "exclamation-circle"}}</div>
          {{/if}}
        </td>
        <td>{{> projectDateInline project}}</td>
        <td>{{project.title}}</td>
        <td>
          <div class="btn-group pull-right">
            <button type="button"
              class="btn btn-sm btn-circle dropdown-toggle {{#if grouping}}disabled{{/if}}"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li class="dropdown-item"><a href="#" data-action="edit" data-id="{{project._id}}" data-type="project">
                {{fa "pencil-square-o"}} {{__ ".edit"}}</a></li>
              <li class="dropdown-item"><a href="#" data-action="delete" data-id="{{project._id}}" data-type="project">
                {{fa "trash-o"}} {{__ ".remove"}}</a></li>
              <li class="dropdown-item"><a href="#" data-action="clone" data-id="{{project._id}}" data-type="project">
                {{fa "clone"}} {{__ ".clone"}}</a></li>
            </ul>
          </div>
        </td>
      </tr>
      <tr><td colspan="4">
        {{> projectStaffingChart project=project }}
      </td></tr>
    {{/each}}
  </table>
</template>

<template name="projectStaffingChart">
  {{> stackedBar barData=(stackedBarData project) hideConfirmed=hideConfirmed }}
</template>

<template name="stackedBar">
  <div class="chart-container">
    <canvas id="StackedBar-{{barData._id}}" class="chart"></canvas>
  </div>
</template>

<template name="teamPie">
  <canvas id="teamPie-{{_id}}" class="chart"></canvas>
</template>

<!-- used to display all tasks for a given team
     Args: team
-->
<template name="teamTasksTable">
  <table class="table">
    <thead>
      <th></th>
      <th>{{__ ".duedate"}}</th>
      <th>{{__ ".name"}}</th>
      <th>{{__ ".positions"}}</th>
      <th></th>
    </thead>
    {{#each shift in allTasks }}
      <tr class="shift" data-id="{{shift._id}}">
        <td>
          {{#if $eq shift.priority "essential"}}
            <div class="text-danger">{{fa "exclamation-circle"}}</div>
          {{/if}}
        </td>
        <td>{{> taskDate shift}}</td>
        <td>{{shift.title}}
          {{#if ($eq shift.policy 'public')}}{{fa 'globe'}}{{/if}}
          {{#if ($eq shift.policy 'private')}}{{fa 'user-secret'}}{{/if}}
          {{#if ($eq shift.policy 'requireApproval')}}{{fa 'lock'}}{{/if}}
        </td>
        <td class="pull-rigth">
          <span class="badge badge-pill badge-primary">{{shift.needed}} / {{shift.confirmed}}</span>
        </td>
        <td>
          <div class="btn-group pull-right">
            <button type="button"
              class="btn btn-default btn-circle dropdown-toggle {{#if grouping}}disabled{{/if}}"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li class="dropdown-item"><a href="#" data-action="edit" data-id="{{shift._id}}">
                {{fa "pencil-square-o"}} {{__ ".edit"}}</a></li>
              <li class="dropdown-item"><a href="#" data-action="delete" data-id="{{shift._id}}">
                {{fa "trash-o"}} {{__ ".remove"}}</a></li>
              <li class="dropdown-item"><a href="#" data-action="clone" data-id="{{shift._id}}">
                {{fa "clone"}} {{__ ".clone"}}</a></li>
            </ul>
          </div>
        </td>
      </tr>
    {{/each}}
  </table>
</template>
